## EventTableMerger

Это небольшое приложение, созданное с использованием Kotlin Multiplatform (KMP), для работы
на компьютерах. Оно интегрируется с Google Drive и работает с Excel таблицами.

## Скриншоты

<div>
<img src="docs/auth.png" width="48%" />
<img src="docs/observe.png" width="48%" />
<img src="docs/search.png" width="48%" />
</div>

## Идея создания

Идея для создания этого приложения появилась в процессе работы. Я работаю в Точке Кипения. Довольно
часто у нас проводятся мероприятия одного формата, куда приходят одни и те же участники. Перед тем
как участники смогут пройти на площадку, их нужно отметить в
системе [Leader-ID](https://leader-id.ru/).
Зачастую участники приходят перед началом мероприятия. Мы ищем участника в базе по ФИО и, когда
находим, отмечаем его на мероприятии. Здесь возникает проблема: поиск участника — не быстрый
процесс, и, самое главное, нужно в правильном порядке указать ФИО для поиска. Это занимает время.
Поэтому было бы здорово создать приложение, которое смогло бы решить проблему долгого поиска и
зависимости от точного написания ФИО.

## Принцип работы

После завершения мероприятия на платформе [Leader-ID](https://leader-id.ru/) можно выгрузить участников в формате Excel таблицы. В приложении необходимо:

1. **Создать новую директорию** или, если вы хотите дополнить новыми участниками, выбрать уже существующую.

2. **Добавить Excel файлы**:
   - Используйте кнопку "Добавить Excel файлы" для выбора нужных файлов.
   - Либо перетащите файлы в соответствующую область приложения.

3. **Обработка данных**:
   - Программа выберет уникальные значения и сформирует итоговую таблицу.
   - Если таблица уже существовала, она будет дополнена уникальными участниками.

4. **Просмотр и поиск**:
   - После объединения файлов в правой части приложения отобразится содержимое таблицы в виде списка.
   - С помощью поля ввода можно осуществить поиск участников по документу.

5. **Копирование ID**:
   - При нажатии на карточку нужного участника его ID сохраняется в буфер обмена.
   - Это позволяет быстро вставить его в систему отметки.

Этот процесс помогает ускорить и упростить работу с участниками мероприятий, минимизируя время на поиск и отметку в системе.

## Структура

Проект написан с использованием Kotlin Multiplatform (KMP). Он состоит из двух основных модулей: `common` и `desktop`.

- **Common Module**: 
  - Содержит всю UI часть проекта, написанную с использованием Jetpack Compose.
  - Использует платформенно-независимые библиотеки, такие как `compose`, `moshi`, и `ktor`.
  - Основная логика приложения и модели данных также находятся здесь, что позволяет повторно использовать их на разных платформах.

- **Desktop Module**: 
  - Содержит специфичный для настольной платформы код.
  - Реализует методы, специфичные для настольной платформы, с помощью Koin для внедрения зависимостей.
  - Управляет взаимодействием с файловой системой и интеграцией с Google Drive API.

##### Использование Koin

Koin используется для управления зависимостями в проекте. Он позволяет легко конфигурировать и внедрять зависимости в различные части приложения. В `desktop` модуле Koin используется для:

- Настройки и предоставления экземпляров классов, специфичных для настольной платформы.

##### Библиотеки
- `lifecycle-viewmodel-compose`: Для управления жизненным циклом ViewModel в Compose.
- `navigation-compose`: Для навигации между экранами в Compose.
- `moshi`: Для сериализации и десериализации JSON.
- `koin`: Для внедрения зависимостей.
- `ktor`: Для сетевых операций.
- `google-api-client`: Для взаимодействия с Google API.
- `google-api-services-drive`: Для работы с Google Drive API.
- `google-oauth-client-jetty`: Для аутентификации с использованием OAuth.

## Сборка проекта

Для запуска проекта нужно сделать следующие действия:

1. Нужно создать проект на платформе Google
   Cloud ([Google Drive API overview](https://developers.google.com/workspace/drive/api/guides/about-sdk), [Develop on Google Workspace](https://developers.google.com/workspace/guides/get-started)).
   Если вкратце, нужно добавить Google Drive API в проект, разрешить обращение по API, создать
   подключение, где нужно будет указать участников, которые имеют доступ к проекту, и сформировать
   credentials на desktop платформу.
2. Скачиваем проект: ```git clone https://github.com/AllWillBePerfect/EventTableMerger.git```.
3. В desktopMain создаем директорию `resources`.
4. В `resources` добавляем файл `credentials.json`.
5. Запускаем проект командой ```gradlew composeApp:run```, или, если нужно создать установщик,
   ```gradlew composeApp:package```.